{"version":3,"sources":["webpack:///./src/views/SettingPage.vue?6a36","webpack:///./src/views/SettingPage.vue?64ee","webpack:///src/views/SettingPage.vue","webpack:///./src/views/SettingPage.vue?9707","webpack:///./src/views/SettingPage.vue","webpack:///./node_modules/core-js/modules/es.array.slice.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","formItems","on","handleOverLength","isProcessing","updateUserInfo","_v","staticRenderFns","name","components","SettingLayout","BaseInput","BaseButton","data","id","value","isError","type","isBlank","isAuthenticated","computed","mapState","created","setUser","methods","password","passwordCheck","account","formData","toast","userAPI","userId","console","component","$","global","isArray","isConstructor","isObject","toAbsoluteIndex","lengthOfArrayLike","toIndexedObject","createProperty","wellKnownSymbol","arrayMethodHasSpeciesSupport","un$Slice","HAS_SPECIES_SUPPORT","SPECIES","Array","max","Math","target","proto","forced","slice","start","end","Constructor","result","n","O","length","k","fin","undefined","constructor","prototype"],"mappings":"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","file":"js/chunk-7df268f6.398f95d5.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SettingPage.vue?vue&type=style&index=0&id=031bbd50&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('setting-layout',[_c('div',{staticClass:\"setting-container\"},[_c('BaseInput',{staticClass:\"setting-input\",attrs:{\"form-items\":_vm.formItems},on:{\"after-over-name-length\":_vm.handleOverLength}}),_c('BaseButton',{staticClass:\"setting-button\",attrs:{\"position\":'right',\"mode\":'action',\"isDisabled\":_vm.isProcessing},on:{\"handleClick\":_vm.updateUserInfo}},[_vm._v(\"儲存\")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <setting-layout>\n    <div class=\"setting-container\">\n      <BaseInput\n        class=\"setting-input\"\n        :form-items=\"formItems\"\n        @after-over-name-length=\"handleOverLength\"\n      />\n      <BaseButton\n        @handleClick=\"updateUserInfo\"\n        class=\"setting-button\"\n        :position=\"'right'\"\n        :mode=\"'action'\"\n        :isDisabled=\"isProcessing\"\n        >儲存</BaseButton\n      >\n    </div>\n  </setting-layout>\n</template>\n\n<script>\nimport SettingLayout from \"../components/layouts/SettingLayout.vue\";\nimport BaseInput from \"../components/UI/BaseInput.vue\";\nimport BaseButton from \"../components/UI/BaseButton.vue\";\nimport userAPI from \"../apis/users\";\nimport { toast } from \"../utils/helper\";\nimport { mapState } from \"vuex\";\n\nexport default {\n  name: \"SettingPage\",\n  components: {\n    SettingLayout,\n    BaseInput,\n    BaseButton,\n  },\n  data() {\n    return {\n      formItems: [\n        {\n          id: 0,\n          name: \"帳號\",\n          value: \"\",\n          isError: false,\n        },\n        {\n          id: 1,\n          name: \"名稱\",\n          value: \"\",\n          isError: false,\n        },\n        {\n          id: 2,\n          name: \"Email\",\n          value: \"\",\n          isError: false,\n        },\n        {\n          id: 3,\n          name: \"密碼\",\n          type: \"password\",\n          value: \"\",\n          isError: false,\n          isBlank: false,\n        },\n        {\n          id: 4,\n          name: \"密碼確認\",\n          type: \"password\",\n          value: \"\",\n          isError: false,\n          isBlank: false,\n        },\n      ],\n      isAuthenticated: false,\n      isProcessing: false,\n    };\n  },\n  computed: {\n    ...mapState([\"currentUser\"]),\n  },\n  created() {\n    this.setUser();\n  },\n  methods: {\n    // 處理名稱超過50個字的函式\n    handleOverLength() {\n      this.formItems[1].isError = true;\n    },\n    // 將currentUser的資料放入input中的函式\n    setUser() {\n        this.isAuthenticated = true;\n\n        this.formItems[0].value = \"@\" + this.currentUser.account;\n        this.formItems[1].value = this.currentUser.name;\n        this.formItems[2].value = this.currentUser.email;\n    },\n    // 透過伺服器更新個人資訊的函式\n    async updateUserInfo() {\n      try {\n        this.isProcessing = true;\n        const id = this.currentUser.id;\n        const password = this.formItems[3].value;\n        const passwordCheck = this.formItems[4].value;\n        const account = this.formItems[0].value\n        const formData = new FormData();\n\n        // 防止使用者刪除@\n        if (account.includes('@') === false) {\n          toast.fireWarning('帳號開頭必需有\"@\"')\n          return\n        } else if (account.length === 1) {\n          toast.fireWarning('帳號空白，請填寫帳號')\n          return\n        }\n\n        formData.append(\"account\", account.slice(1));\n        formData.append(\"name\", this.formItems[1].value);\n        formData.append(\"email\", this.formItems[2].value);\n        formData.append(\"password\", this.formItems[3].value);\n        formData.append(\"introduction\", this.currentUser.introduction);\n        formData.append(\"avatar\", this.currentUser.avatar);\n        formData.append(\"cover\", this.currentUser.cover);\n\n        // 當密碼輸入不相同時\n        if (password !== passwordCheck) {\n          this.formItems[3].isError = true;\n          this.formItems[4].isError = true;\n          return;\n        } else {\n          // 將提示訊息還原\n          this.formItems[3].isError = false;\n          this.formItems[4].isError = false;\n        }\n\n        if (this.formItems[1].value.length > 50) return;\n\n        // 向API傳送更新的資訊\n        const { data } = await userAPI.update({\n          userId: id,\n          formData,\n        });\n\n        // 當帳號重覆時\n        if (\n          data.status === \"error\" &&\n          data.message === \"Account should be unique.\"\n        ) {\n          console.log(data.message);\n          this.formItems[0].isError = true;\n          return;\n        } else if (\n          data.status === \"error\" &&\n          data.message === \"Email should be unique.\"\n        ) {\n          // 當email重覆時\n          console.log(data.message);\n          this.formItems[2].isError = true;\n          return;\n        } else {\n          // 更新成功時的訊息\n          toast.fireSuccess(\"更新成功\");\n          this.$router.push(\"/main\");\n        }\n      } catch (error) {\n        console.log(\"Error\", error);\n        toast.fireError(\"目前無法修改設定，請稍後再試\");\n      } finally {\n        this.isProcessing = false;\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.setting-container {\n  margin: 1rem;\n  > .setting-link > .setting-button {\n    color: var(--white-text-color);\n    width: 5rem;\n    height: 100%;\n    padding: 0.5rem 0;\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SettingPage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SettingPage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SettingPage.vue?vue&type=template&id=031bbd50&scoped=true&\"\nimport script from \"./SettingPage.vue?vue&type=script&lang=js&\"\nexport * from \"./SettingPage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SettingPage.vue?vue&type=style&index=0&id=031bbd50&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"031bbd50\",\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar isArray = require('../internals/is-array');\nvar isConstructor = require('../internals/is-constructor');\nvar isObject = require('../internals/is-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar createProperty = require('../internals/create-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar un$Slice = require('../internals/array-slice');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('slice');\n\nvar SPECIES = wellKnownSymbol('species');\nvar Array = global.Array;\nvar max = Math.max;\n\n// `Array.prototype.slice` method\n// https://tc39.es/ecma262/#sec-array.prototype.slice\n// fallback for not array-like ES3 strings and DOM objects\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  slice: function slice(start, end) {\n    var O = toIndexedObject(this);\n    var length = lengthOfArrayLike(O);\n    var k = toAbsoluteIndex(start, length);\n    var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n    // inline `ArraySpeciesCreate` for usage native `Array#slice` where it's possible\n    var Constructor, result, n;\n    if (isArray(O)) {\n      Constructor = O.constructor;\n      // cross-realm fallback\n      if (isConstructor(Constructor) && (Constructor === Array || isArray(Constructor.prototype))) {\n        Constructor = undefined;\n      } else if (isObject(Constructor)) {\n        Constructor = Constructor[SPECIES];\n        if (Constructor === null) Constructor = undefined;\n      }\n      if (Constructor === Array || Constructor === undefined) {\n        return un$Slice(O, k, fin);\n      }\n    }\n    result = new (Constructor === undefined ? Array : Constructor)(max(fin - k, 0));\n    for (n = 0; k < fin; k++, n++) if (k in O) createProperty(result, n, O[k]);\n    result.length = n;\n    return result;\n  }\n});\n"],"sourceRoot":""}